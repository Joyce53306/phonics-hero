<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Short Vowel Hero üåà</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --color-a: #FF8A80; --color-e: #81C784; --color-i: #64B5F6;
            --color-o: #FFB74D; --color-u: #BA68C8; --color-review: #FFD700;
        }
        body {
            font-family: 'Arial Rounded MT Bold', sans-serif;
            background-color: #E0F7FA; margin: 0; padding: 10px;
            display: flex; justify-content: center;
        }
        .app-container {
            background: white; width: 100%; max-width: 500px;
            border-radius: 40px; border: 6px solid #333;
            padding: 20px; text-align: center; box-shadow: 0 12px 0 #B0BEC5;
        }
        
        /* È†ÇÈÉ®ÈÅ∏ÂñÆ 3x2 ÊéíÁâà */
        .tab-menu {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
            margin-bottom: 20px; background: #F5F5F5;
            padding: 15px; border-radius: 30px; border: 3px solid #DDD;
        }
        .tab-btn {
            padding: 12px; border-radius: 15px; border: none; color: white;
            font-weight: bold; font-size: 1.2rem; cursor: pointer;
            border-bottom: 4px solid rgba(0,0,0,0.2); transition: 0.1s;
        }
        .tab-btn.active { transform: scale(0.95); border-bottom: 0; box-shadow: inset 0 4px 4px rgba(0,0,0,0.2); }

        /* Á∑¥ÁøíÂçÄ */
        .speaker-btn {
            background: #FFF9C4; border: 4px solid #FBC02D;
            border-radius: 30px; padding: 25px; cursor: pointer;
            width: 100%; box-sizing: border-box; margin-bottom: 15px;
        }
        .word-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .opt-btn {
            background: #FFF; border: 4px solid #EEE; padding: 25px;
            border-radius: 20px; font-size: 1.8rem; font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 0 #DDD;
        }

        /* ÈåÑÈü≥ÂõûÈ•ãÂçÄ */
        .record-panel {
            margin-top: 20px; padding: 20px; border-radius: 25px;
            background: #F9F9F9; border: 3px dashed #90A4AE; display: none;
        }
        .mic-btn {
            background: #FF5252; color: white; border: none;
            width: 100%; padding: 15px; border-radius: 20px; font-size: 1.3rem;
            cursor: pointer;
        }
        .hear-me-big {
            background: #4CAF50; color: white; border: none;
            width: 100%; padding: 25px; border-radius: 25px;
            font-size: 2.2rem; font-weight: bold; margin-top: 15px;
            border-bottom: 8px solid #2E7D32; display: none;
            animation: bounce 1.2s infinite;
        }
        @keyframes bounce { 0%, 100% {transform: scale(1);} 50% {transform: scale(1.05);} }
        
        .next-arrow { margin-top: 15px; font-size: 1.3rem; color: #555; cursor: pointer; background: #EEE; border: none; padding: 10px; border-radius: 10px; width: 100%; }
    </style>
</head>
<body>

<div class="app-container">
    <h2 id="modeTitle" style="margin: 0 0 10px 0; color: #555;">Short Vowel: A</h2>
    
    <div class="tab-menu">
        <button class="tab-btn" id="btnA" style="background:var(--color-a)" onclick="switchVowel('A')">a</button>
        <button class="tab-btn" id="btnE" style="background:var(--color-e)" onclick="switchVowel('E')">e</button>
        <button class="tab-btn" id="btnI" style="background:var(--color-i)" onclick="switchVowel('I')">i</button>
        <button class="tab-btn" id="btnO" style="background:var(--color-o)" onclick="switchVowel('O')">o</button>
        <button class="tab-btn" id="btnU" style="background:var(--color-u)" onclick="switchVowel('U')">u</button>
        <button class="tab-btn" id="btnReview" style="background:var(--color-review); color:#333;" onclick="switchVowel('Review')">‚≠ê ALL</button>
    </div>

    <div class="play-area">
        <div class="speaker-btn" onclick="playTeacher()">
            <span style="font-size: 50px;">üëÇ</span>
            <p style="font-weight:bold; color:#F57F17; margin:0;">Listen to Teacher</p>
        </div>

        <div class="word-grid" id="optionsContainer"></div>
        <div id="statusMsg" style="font-size: 1.5rem; font-weight: bold; margin: 15px 0;"></div>

        <div class="record-panel" id="recordSection">
            <button class="mic-btn" id="micBtn">üé§ Start Recording</button>
            <button class="hear-me-big" id="playMeBtn">üëÇ HEAR ME!</button>
            <button class="next-arrow" onclick="nextQuestion()">Next Word ‚û°Ô∏è</button>
        </div>
    </div>
</div>

<script>
    // Áü≠ÊØçÈü≥ÂñÆÂ≠óÂ∫´
    const shortVowels = {
        'A': ['cat', 'hat', 'bat', 'map', 'cap', 'tap', 'pan', 'fan', 'bag', 'tag', 'jam', 'ham', 'sad', 'mad'],
        'E': ['bed', 'red', 'net', 'pet', 'wet', 'jet', 'hen', 'pen', 'ten', 'leg', 'peg', 'web'],
        'I': ['pig', 'big', 'wig', 'bin', 'fin', 'pin', 'sit', 'hit', 'kit', 'lip', 'tip', 'zip', 'mix', 'six'],
        'O': ['hot', 'pot', 'dot', 'box', 'fox', 'hop', 'mop', 'top', 'dog', 'log', 'job', 'rob'],
        'U': ['sun', 'run', 'bun', 'cup', 'pup', 'bug', 'hug', 'jug', 'rug', 'tub', 'mud', 'gum', 'bus']
    };

    let currentGroup = 'A';
    let currentWord = '';
    let mediaRecorder;
    let audioChunks = [];

    function switchVowel(v) {
        currentGroup = v;
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('btn' + v).classList.add('active');
        document.getElementById('modeTitle').innerText = (v === 'Review') ? "‚≠ê Mixed Short Vowels ‚≠ê" : "Short Vowel: " + v;
        nextQuestion();
    }

    function nextQuestion() {
        let pool = [];
        if (currentGroup === 'Review') {
            pool = [].concat(...Object.values(shortVowels));
        } else {
            pool = shortVowels[currentGroup];
        }

        currentWord = pool[Math.floor(Math.random() * pool.length)];
        let distract = pool[Math.floor(Math.random() * pool.length)];
        while(distract === currentWord) distract = pool[Math.floor(Math.random() * pool.length)];

        document.getElementById('recordSection').style.display = 'none';
        document.getElementById('playMeBtn').style.display = 'none';
        document.getElementById('statusMsg').innerText = "";
        
        const container = document.getElementById('optionsContainer');
        container.innerHTML = "";
        [currentWord, distract].sort(() => Math.random() - 0.5).forEach(w => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = w;
            btn.onclick = () => check(w);
            container.appendChild(btn);
        });
        playTeacher();
    }

    function playTeacher() {
        const u = new SpeechSynthesisUtterance(currentWord);
        u.lang = 'en-US'; u.rate = 0.7;
        window.speechSynthesis.speak(u);
    }

    function check(selected) {
        if(selected === currentWord) {
            const count = (currentGroup === 'Review') ? 300 : 100;
            confetti({ particleCount: count, spread: 80, origin: { y: 0.7 } });
            document.getElementById('statusMsg').innerText = "üèÜ YOU GOT IT!";
            document.getElementById('statusMsg').style.color = "#4CAF50";
            document.getElementById('recordSection').style.display = 'block';
        } else {
            document.getElementById('statusMsg').innerText = "Try Again! üí™";
            document.getElementById('statusMsg').style.color = "#FF5252";
        }
    }

    const micBtn = document.getElementById('micBtn');
    const playMeBtn = document.getElementById('playMeBtn');
    micBtn.onclick = async () => {
        if (!mediaRecorder || mediaRecorder.state === 'inactive') {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.start();
            audioChunks = [];
            micBtn.innerText = "üõë Recording...";
            micBtn.style.background = "#000";
        } else {
            mediaRecorder.stop();
            micBtn.innerText = "üé§ Record Again";
            micBtn.style.background = "#FF5252";
        }
        mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
        mediaRecorder.onstop = () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
            const audioUrl = URL.createObjectURL(audioBlob);
            const audio = new Audio(audioUrl);
            playMeBtn.style.display = 'block';
            playMeBtn.onclick = () => audio.play();
        };
    };

    window.onload = () => switchVowel('A');
</script>

</body>
</html>
